
<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<title>elice_3_2_21</title>
</head>
<body>

<div class="" data-reactid=".0.3.0.0.0.0.0"><div class="instruction-content" data-reactid=".0.3.0.0.0.0.0.0"><h2 id="naivebayesclassifier1">Naive Bayes Classifier (1)</h2>

<p>Naive Bayes Classifier (나이브 베이즈 분류기) 는 베이즈 정리를 활용한 확률 분류기 (probabilistic classifier) 입니다. 나이브 베이즈는 간단한 특성으로 인해 복잡하지 않은 문제에서 광범위하게 이용되고 있습니다. 이러한 분류 알고리즘 중 더 진보된 알고리즘은 Support Vector Machine (서포트 벡터 머신) 으로 우리가 앞으로 4주차에 배울 알고리즘입니다.</p>

<p>나이브 베이즈 분류를 본격적으로 배우기 전에 likelihood가 무엇인지 직접 구현을 통해 알아보겠습니다.</p>

<h4 id="likelihood">Likelihood</h4>

<p>Likelihood (가능도 혹은 우도) 는 일반적으로 "확률" 과 비슷한 개념입니다. 확률 및 통계학에서, likelihood는 확률 분포의 parameter (모수) 가 관찰된 sample (표집값) 과 일치하는 정도를 나타내는 parameter에 대한 함수입니다. 예를 들어, 동전 던지기 문제를 생각해봅시다. 동전을 여러 번 던질 때, 각각 앞면 혹은 뒷면이 나오는 사건은 독립사건입니다. 동전을 한 번 던졌을 때 앞면이 나올 확률을 <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>θ</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height: 0.69444em;"></span><span class="strut bottom" style="height: 0.69444em; vertical-align: 0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span></span></span></span></span> 라고 합시다. 동전을 10번 던져서 10번 다 앞이 나왔다고 할 때 likelihood 는 <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>θ</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height: 0.69444em;"></span><span class="strut bottom" style="height: 0.69444em; vertical-align: 0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span></span></span></span></span> 를 열 번 곱한 <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>L</mi><mo>(</mo><mi>θ</mi><mi mathvariant="normal">∣</mi><mi>x</mi><mo>)</mo><mo>=</mo><msup><mi>θ</mi><mrow><mn>1</mn><mn>0</mn></mrow></msup></mrow><annotation encoding="application/x-tex">L(\theta|x) = \theta^{10}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height: 0.814108em;"></span><span class="strut bottom" style="height: 1.064108em; vertical-align: -0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit">L</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="mord">∣</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="vlist"><span class="" style="top: -0.363em; margin-right: 0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord">1</span><span class="mord">0</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span>​</span></span></span></span></span></span></span> 이 됩니다.</p>

<p>이것을 이용하면 관찰된 표집값에 가장 적합한 모델을 골라내는데에 사용할 수 있습니다. 예를 들어, 동전을 10번 던져서 앞면이 8번 뒷면이 2번 나온 실험을 진행했고 (이것을 <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height: 0.43056em;"></span><span class="strut bottom" style="height: 0.43056em; vertical-align: 0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">x</span></span></span></span></span> 라고 합시다), 두 동전 <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height: 0.64444em;"></span><span class="strut bottom" style="height: 0.64444em; vertical-align: 0em;"></span><span class="base textstyle uncramped"><span class="mord">1</span></span></span></span></span>, <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>2</mn></mrow><annotation encoding="application/x-tex">2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height: 0.64444em;"></span><span class="strut bottom" style="height: 0.64444em; vertical-align: 0em;"></span><span class="base textstyle uncramped"><span class="mord">2</span></span></span></span></span>가 있다고 합시다. 그리고 동전 <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height: 0.64444em;"></span><span class="strut bottom" style="height: 0.64444em; vertical-align: 0em;"></span><span class="base textstyle uncramped"><span class="mord">1</span></span></span></span></span> 의 앞면이 나올 확률 <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>θ</mi><mn>1</mn></msub><mo>=</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>7</mn></mrow><annotation encoding="application/x-tex">\theta_1 = 0.7</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height: 0.69444em;"></span><span class="strut bottom" style="height: 0.84444em; vertical-align: -0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="vlist"><span class="" style="top: 0.15em; margin-right: 0.05em; margin-left: -0.02778em;"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord">0</span><span class="mord">.</span><span class="mord">7</span></span></span></span></span>, 동전 <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>2</mn></mrow><annotation encoding="application/x-tex">2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height: 0.64444em;"></span><span class="strut bottom" style="height: 0.64444em; vertical-align: 0em;"></span><span class="base textstyle uncramped"><span class="mord">2</span></span></span></span></span> 의 앞면이 나올 확률 <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>θ</mi><mn>2</mn></msub><mo>=</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>4</mn></mrow><annotation encoding="application/x-tex">\theta_2 = 0.4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height: 0.69444em;"></span><span class="strut bottom" style="height: 0.84444em; vertical-align: -0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="vlist"><span class="" style="top: 0.15em; margin-right: 0.05em; margin-left: -0.02778em;"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord">0</span><span class="mord">.</span><span class="mord">4</span></span></span></span></span> 라고 하면</p>

<p><span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>L</mi><mo>(</mo><msub><mi>θ</mi><mn>1</mn></msub><mi mathvariant="normal">∣</mi><mi>x</mi><mo>)</mo><mo>=</mo><mi>P</mi><mo>(</mo><mi>x</mi><mi mathvariant="normal">∣</mi><msub><mi>θ</mi><mn>1</mn></msub><mo>)</mo><mo>=</mo></mrow><annotation encoding="application/x-tex">L(\theta_1|x) = P(x|\theta_1) = </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height: 0.75em;"></span><span class="strut bottom" style="height: 1em; vertical-align: -0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit">L</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="vlist"><span class="" style="top: 0.15em; margin-right: 0.05em; margin-left: -0.02778em;"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span>​</span></span></span><span class="mord">∣</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mord">∣</span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="vlist"><span class="" style="top: 0.15em; margin-right: 0.05em; margin-left: -0.02778em;"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span>​</span></span></span><span class="mclose">)</span><span class="mrel">=</span></span></span></span></span>
 <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>0</mn><mi mathvariant="normal">.</mi><msup><mn>7</mn><mn>8</mn></msup><mo>∗</mo><mo>(</mo><mn>1</mn><mo>−</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>7</mn><msup><mo>)</mo><mn>2</mn></msup><mo>∼</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>0</mn><mn>0</mn><mn>5</mn><mn>1</mn><mn>8</mn><mn>8</mn></mrow><annotation encoding="application/x-tex">0.7^8 * (1-0.7)^2 \sim 0.005188</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height: 0.814108em;"></span><span class="strut bottom" style="height: 1.064108em; vertical-align: -0.25em;"></span><span class="base textstyle uncramped"><span class="mord">0</span><span class="mord">.</span><span class="mord"><span class="mord">7</span><span class="vlist"><span class="" style="top: -0.363em; margin-right: 0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord">8</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span>​</span></span></span><span class="mbin">∗</span><span class="mopen">(</span><span class="mord">1</span><span class="mbin">−</span><span class="mord">0</span><span class="mord">.</span><span class="mord">7</span><span class="mclose"><span class="mclose">)</span><span class="vlist"><span class="" style="top: -0.363em; margin-right: 0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span>​</span></span></span><span class="mrel">∼</span><span class="mord">0</span><span class="mord">.</span><span class="mord">0</span><span class="mord">0</span><span class="mord">5</span><span class="mord">1</span><span class="mord">8</span><span class="mord">8</span></span></span></span></span></p>

<p><span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>L</mi><mo>(</mo><msub><mi>θ</mi><mn>2</mn></msub><mi mathvariant="normal">∣</mi><mi>x</mi><mo>)</mo><mo>=</mo><mi>P</mi><mo>(</mo><mi>x</mi><mi mathvariant="normal">∣</mi><msub><mi>θ</mi><mn>2</mn></msub><mo>)</mo><mo>=</mo></mrow><annotation encoding="application/x-tex">L(\theta_2|x) = P(x|\theta_2) = </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height: 0.75em;"></span><span class="strut bottom" style="height: 1em; vertical-align: -0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit">L</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="vlist"><span class="" style="top: 0.15em; margin-right: 0.05em; margin-left: -0.02778em;"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span>​</span></span></span><span class="mord">∣</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mord">∣</span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="vlist"><span class="" style="top: 0.15em; margin-right: 0.05em; margin-left: -0.02778em;"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span>​</span></span></span><span class="mclose">)</span><span class="mrel">=</span></span></span></span></span>
 <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>0</mn><mi mathvariant="normal">.</mi><msup><mn>4</mn><mn>8</mn></msup><mo>∗</mo><mo>(</mo><mn>1</mn><mo>−</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>4</mn><msup><mo>)</mo><mn>2</mn></msup><mo>∼</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>0</mn><mn>0</mn><mn>0</mn><mn>2</mn><mn>3</mn><mn>6</mn></mrow><annotation encoding="application/x-tex">0.4^8 * (1-0.4)^2 \sim 0.000236</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height: 0.814108em;"></span><span class="strut bottom" style="height: 1.064108em; vertical-align: -0.25em;"></span><span class="base textstyle uncramped"><span class="mord">0</span><span class="mord">.</span><span class="mord"><span class="mord">4</span><span class="vlist"><span class="" style="top: -0.363em; margin-right: 0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord">8</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span>​</span></span></span><span class="mbin">∗</span><span class="mopen">(</span><span class="mord">1</span><span class="mbin">−</span><span class="mord">0</span><span class="mord">.</span><span class="mord">4</span><span class="mclose"><span class="mclose">)</span><span class="vlist"><span class="" style="top: -0.363em; margin-right: 0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span>​</span></span></span><span class="mrel">∼</span><span class="mord">0</span><span class="mord">.</span><span class="mord">0</span><span class="mord">0</span><span class="mord">0</span><span class="mord">2</span><span class="mord">3</span><span class="mord">6</span></span></span></span></span></p>

<p>이므로 두 동전의 likelihood를 비교하면 동전 <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height: 0.64444em;"></span><span class="strut bottom" style="height: 0.64444em; vertical-align: 0em;"></span><span class="base textstyle uncramped"><span class="mord">1</span></span></span></span></span> 의 likelihood가 훨씬 높으므로, 동전 <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height: 0.64444em;"></span><span class="strut bottom" style="height: 0.64444em; vertical-align: 0em;"></span><span class="base textstyle uncramped"><span class="mord">1</span></span></span></span></span> 이 실험 결과를 훨씬 더 잘 설명한다고 할 수 있습니다.</p>

<h4 id="laplacesmoothing">Laplace Smoothing</h4>

<p>통계학에서 Laplace smoothing (혹은 additive smoothing 이라고 불림) 은 카테고리를 가진 데이터의 확률을 <strong>부드럽게</strong> 만들어주는 기법입니다. 이 기법은 일어나지 않은 사건을 예측할 때 이미 관측되지 않은 카테고리에도 0이라는 확률을 주지 않게 하기 위해서 만들어졌습니다.</p>

<p>만약 스위치를 누를때마다 빨간색, 녹색, 파란색 사탕 세 개 중 임의로 하나를 뽑아준다고 광고하는 기계 앞에 있다고 생각합시다. 그리고 스위치를 충분히 많이 눌렀을 때, 빨간색과 녹색은 고루 나왔지만 파란색 사탕이 한 번도 나오지 않았다고 합시다. 이 기계에서 파란색 사탕이 나올 확률은 정확히 0일까요? 그럴 수도 있지만, 우리는 이 기계에서 파란 사탕이 안 나온다고 확신할 수 없습니다. 스위치를 훨씬 더 많이 눌러서 빨간색과 녹색 사탕이 더 많이 나오고 파란색이 나오지 않았을지라도 파란 사탕이 나올 확률을 0이라고 단언할 수는 없습니다. 정말 정말 낮은 확률로 파란 사탕이 우연히 나오지 않은 것일수도 있기 때문입니다. 이렇기 때문에 파란 사탕이 나올 확률을 매우 작은 확률로 두게 됩니다.</p>

<p>Laplace sampling은 다음과 같이 표현됩니다.</p>

<p><span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><msub><mi>θ</mi><mi>i</mi></msub><mo>=</mo><mfrac><mrow><msub><mi>x</mi><mi>i</mi></msub><mo>+</mo><mi>α</mi></mrow><mrow><mi>N</mi><mo>+</mo><mi>α</mi><mi>d</mi></mrow></mfrac></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle \theta_i = \frac{x_i + \alpha}{N + \alpha d}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height: 1.26033em;"></span><span class="strut bottom" style="height: 2.02966em; vertical-align: -0.76933em;"></span><span class="base textstyle uncramped"><span class="reset-textstyle displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="vlist"><span class="" style="top: 0.15em; margin-right: 0.05em; margin-left: -0.02778em;"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span class="" style="top: 0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathit" style="margin-right: 0.10903em;">N</span><span class="mbin">+</span><span class="mord mathit" style="margin-right: 0.0037em;">α</span><span class="mord mathit">d</span></span></span></span><span class="" style="top: -0.23em;"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span class="" style="top: -0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span class="" style="top: 0.15em; margin-right: 0.05em; margin-left: 0em;"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span>​</span></span></span><span class="mbin">+</span><span class="mord mathit" style="margin-right: 0.0037em;">α</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span></span></span></p>

<p>위의 수식에서 <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>θ</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\theta_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height: 0.69444em;"></span><span class="strut bottom" style="height: 0.84444em; vertical-align: -0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="vlist"><span class="" style="top: 0.15em; margin-right: 0.05em; margin-left: -0.02778em;"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span>​</span></span></span></span></span></span></span> 는 <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>i</mi><mo>∈</mo><mrow><mi>r</mi><mi>e</mi><mi>d</mi><mo separator="true">,</mo><mi>g</mi><mi>r</mi><mi>e</mi><mi>e</mi><mi>n</mi><mo separator="true">,</mo><mi>b</mi><mi>l</mi><mi>u</mi><mi>e</mi></mrow></mrow><annotation encoding="application/x-tex">i \in {red, green, blue}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height: 0.69444em;"></span><span class="strut bottom" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit">i</span><span class="mrel">∈</span><span class="mord textstyle uncramped"><span class="mord mathit" style="margin-right: 0.02778em;">r</span><span class="mord mathit">e</span><span class="mord mathit">d</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right: 0.03588em;">g</span><span class="mord mathit" style="margin-right: 0.02778em;">r</span><span class="mord mathit">e</span><span class="mord mathit">e</span><span class="mord mathit">n</span><span class="mpunct">,</span><span class="mord mathit">b</span><span class="mord mathit" style="margin-right: 0.01968em;">l</span><span class="mord mathit">u</span><span class="mord mathit">e</span></span></span></span></span></span> 일 때 각각 빨간색, 초록색, 파란색 사탕이 나올 확률을 의미합니다 (우리가 정확한 확률을 알 수 없으므로, 이 확률은 관찰한 사탕의 개수에 의존합니다). <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>x</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">x_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height: 0.43056em;"></span><span class="strut bottom" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span class="" style="top: 0.15em; margin-right: 0.05em; margin-left: 0em;"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span>​</span></span></span></span></span></span></span> 는 <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height: 0.65952em;"></span><span class="strut bottom" style="height: 0.65952em; vertical-align: 0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">i</span></span></span></span></span> 색 사탕이 나온 횟수입니다. 이를테면 10번 사탕을 뽑아서 빨간색이 6번, 녹색이 4번 나왔다면 <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>x</mi><mrow><mi>r</mi><mi>e</mi><mi>d</mi></mrow></msub><mo>=</mo><mn>6</mn></mrow><annotation encoding="application/x-tex">x_{red} = 6</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height: 0.64444em;"></span><span class="strut bottom" style="height: 0.79444em; vertical-align: -0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span class="" style="top: 0.15em; margin-right: 0.05em; margin-left: 0em;"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right: 0.02778em;">r</span><span class="mord mathit">e</span><span class="mord mathit">d</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord">6</span></span></span></span></span>, <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>x</mi><mrow><mi>g</mi><mi>r</mi><mi>e</mi><mi>e</mi><mi>n</mi></mrow></msub><mo>=</mo><mn>4</mn></mrow><annotation encoding="application/x-tex">x_{green} = 4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height: 0.64444em;"></span><span class="strut bottom" style="height: 0.930548em; vertical-align: -0.286108em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span class="" style="top: 0.15em; margin-right: 0.05em; margin-left: 0em;"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right: 0.03588em;">g</span><span class="mord mathit" style="margin-right: 0.02778em;">r</span><span class="mord mathit">e</span><span class="mord mathit">e</span><span class="mord mathit">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord">4</span></span></span></span></span> 가 됩니다. <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>α</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height: 0.43056em;"></span><span class="strut bottom" style="height: 0.43056em; vertical-align: 0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right: 0.0037em;">α</span></span></span></span></span> 는 laplace sampling 시에 두는 파라미터로, <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>α</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height: 0.43056em;"></span><span class="strut bottom" style="height: 0.43056em; vertical-align: 0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right: 0.0037em;">α</span></span></span></span></span>가 작을수록 관측되지 않은 카테고리에 대해 확률을 작게 두게 됩니다. 이를테면, <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>α</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height: 0.43056em;"></span><span class="strut bottom" style="height: 0.43056em; vertical-align: 0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right: 0.0037em;">α</span></span></span></span></span>가 작을수록 아직 나오지 않은 파란 색 사탕이 나올 확률을 작게 두는 것입니다. <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height: 0.68333em;"></span><span class="strut bottom" style="height: 0.68333em; vertical-align: 0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right: 0.10903em;">N</span></span></span></span></span>은 색깔에 관계없이 지금까지 관찰한 사탕의 개수이고, <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height: 0.69444em;"></span><span class="strut bottom" style="height: 0.69444em; vertical-align: 0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">d</span></span></span></span></span>는 사탕 색깔의 개수 (3) 입니다. <em>여기서 <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi><mo>=</mo><mn>3</mn></mrow><annotation encoding="application/x-tex">d = 3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height: 0.69444em;"></span><span class="strut bottom" style="height: 0.69444em; vertical-align: 0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">d</span><span class="mrel">=</span><span class="mord">3</span></span></span></span></span> 인 이유는, 우리가 이미 사탕이 3가지 종류라는 것을 알고 있기 때문입니다.</em> 위의 식을 살펴보면, 만약 파란 사탕이 계속 나오지 않는 상태에서 스위치를 계속 누르면 누를수록 <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height: 0.68333em;"></span><span class="strut bottom" style="height: 0.68333em; vertical-align: 0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right: 0.10903em;">N</span></span></span></span></span> 값이 커지기 때문에 파란 사탕이 나올 확률은 0에 점점 가까워지게 낮아지게 됨을 알 수 있습니다.</p>

<p><span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>x</mi><mrow><mi>r</mi><mi>e</mi><mi>d</mi></mrow></msub><mo>=</mo><mn>6</mn></mrow><annotation encoding="application/x-tex">x_{red} = 6</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height: 0.64444em;"></span><span class="strut bottom" style="height: 0.79444em; vertical-align: -0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span class="" style="top: 0.15em; margin-right: 0.05em; margin-left: 0em;"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right: 0.02778em;">r</span><span class="mord mathit">e</span><span class="mord mathit">d</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord">6</span></span></span></span></span>, <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>x</mi><mrow><mi>g</mi><mi>r</mi><mi>e</mi><mi>e</mi><mi>n</mi></mrow></msub><mo>=</mo><mn>4</mn></mrow><annotation encoding="application/x-tex">x_{green} = 4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height: 0.64444em;"></span><span class="strut bottom" style="height: 0.930548em; vertical-align: -0.286108em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span class="" style="top: 0.15em; margin-right: 0.05em; margin-left: 0em;"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right: 0.03588em;">g</span><span class="mord mathit" style="margin-right: 0.02778em;">r</span><span class="mord mathit">e</span><span class="mord mathit">e</span><span class="mord mathit">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord">4</span></span></span></span></span> 인 경우 Laplace smoothing 을 적용해 보겠습니다. 먼저, smoothing 의 적용이 없다면 빨간색 사탕이 6개, 초록색 사탕이 4개 나올 확률을 최대로 만드는 기계는 다음의 확률을 가진 기계입니다.</p>

<ul>
<li>빨강: <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>θ</mi><mrow><mi>r</mi><mi>e</mi><mi>d</mi></mrow></msub><mo>=</mo><mfrac><mrow><mn>6</mn></mrow><mrow><mn>1</mn><mn>0</mn></mrow></mfrac><mo>=</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>6</mn></mrow><annotation encoding="application/x-tex">\theta_{red} = \frac{6}{10} = 0.6</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height: 0.845108em;"></span><span class="strut bottom" style="height: 1.190108em; vertical-align: -0.345em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="vlist"><span class="" style="top: 0.15em; margin-right: 0.05em; margin-left: -0.02778em;"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right: 0.02778em;">r</span><span class="mord mathit">e</span><span class="mord mathit">d</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord reset-textstyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span class="" style="top: 0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord">1</span><span class="mord">0</span></span></span></span><span class="" style="top: -0.23em;"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span class="" style="top: -0.394em;"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord">6</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mrel">=</span><span class="mord">0</span><span class="mord">.</span><span class="mord">6</span></span></span></span></span></li>
<li>초록: <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>θ</mi><mrow><mi>g</mi><mi>r</mi><mi>e</mi><mi>e</mi><mi>n</mi></mrow></msub><mo>=</mo><mfrac><mrow><mn>4</mn></mrow><mrow><mn>1</mn><mn>0</mn></mrow></mfrac><mo>=</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>4</mn></mrow><annotation encoding="application/x-tex">\theta_{green} = \frac{4}{10} = 0.4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height: 0.845108em;"></span><span class="strut bottom" style="height: 1.190108em; vertical-align: -0.345em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="vlist"><span class="" style="top: 0.15em; margin-right: 0.05em; margin-left: -0.02778em;"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right: 0.03588em;">g</span><span class="mord mathit" style="margin-right: 0.02778em;">r</span><span class="mord mathit">e</span><span class="mord mathit">e</span><span class="mord mathit">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord reset-textstyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span class="" style="top: 0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord">1</span><span class="mord">0</span></span></span></span><span class="" style="top: -0.23em;"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span class="" style="top: -0.394em;"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord">4</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mrel">=</span><span class="mord">0</span><span class="mord">.</span><span class="mord">4</span></span></span></span></span></li>
<li>파랑: <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>θ</mi><mrow><mi>b</mi><mi>l</mi><mi>u</mi><mi>e</mi></mrow></msub><mo>=</mo><mfrac><mrow><mn>0</mn></mrow><mrow><mn>1</mn><mn>0</mn></mrow></mfrac><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\theta_{blue} = \frac{0}{10} = 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height: 0.845108em;"></span><span class="strut bottom" style="height: 1.190108em; vertical-align: -0.345em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="vlist"><span class="" style="top: 0.15em; margin-right: 0.05em; margin-left: -0.02778em;"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">b</span><span class="mord mathit" style="margin-right: 0.01968em;">l</span><span class="mord mathit">u</span><span class="mord mathit">e</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord reset-textstyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span class="" style="top: 0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord">1</span><span class="mord">0</span></span></span></span><span class="" style="top: -0.23em;"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span class="" style="top: -0.394em;"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord">0</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mrel">=</span><span class="mord">0</span></span></span></span></span></li>
</ul>

<p>만약 바로 다음 파란색 사탕을 뽑았을 경우 이 모델로 설명할 수가 없게 됩니다. 이를 위해 Laplace smoothing을 적용하면 (<span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>α</mi><mo>=</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>1</mn></mrow><annotation encoding="application/x-tex">\alpha = 0.1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height: 0.64444em;"></span><span class="strut bottom" style="height: 0.64444em; vertical-align: 0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right: 0.0037em;">α</span><span class="mrel">=</span><span class="mord">0</span><span class="mord">.</span><span class="mord">1</span></span></span></span></span>)</p>

<ul>
<li>빨강: <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>θ</mi><mrow><mi>r</mi><mi>e</mi><mi>d</mi></mrow></msub><mo>=</mo><mfrac><mrow><mn>6</mn><mo>+</mo><mi>α</mi></mrow><mrow><mn>1</mn><mn>0</mn><mo>+</mo><mn>3</mn><mi>α</mi></mrow></mfrac><mo>∼</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>5</mn><mn>9</mn><mn>2</mn><mn>2</mn></mrow><annotation encoding="application/x-tex">\theta_{red} = \frac{6 + \alpha}{10 + 3\alpha} \sim 0.5922</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height: 0.845108em;"></span><span class="strut bottom" style="height: 1.248439em; vertical-align: -0.403331em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="vlist"><span class="" style="top: 0.15em; margin-right: 0.05em; margin-left: -0.02778em;"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right: 0.02778em;">r</span><span class="mord mathit">e</span><span class="mord mathit">d</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord reset-textstyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span class="" style="top: 0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord">1</span><span class="mord">0</span><span class="mbin">+</span><span class="mord">3</span><span class="mord mathit" style="margin-right: 0.0037em;">α</span></span></span></span><span class="" style="top: -0.23em;"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span class="" style="top: -0.394em;"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord">6</span><span class="mbin">+</span><span class="mord mathit" style="margin-right: 0.0037em;">α</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mrel">∼</span><span class="mord">0</span><span class="mord">.</span><span class="mord">5</span><span class="mord">9</span><span class="mord">2</span><span class="mord">2</span></span></span></span></span></li>
<li>초록: <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>θ</mi><mrow><mi>g</mi><mi>r</mi><mi>e</mi><mi>e</mi><mi>n</mi></mrow></msub><mo>=</mo><mfrac><mrow><mn>4</mn><mo>+</mo><mi>α</mi></mrow><mrow><mn>1</mn><mn>0</mn><mo>+</mo><mn>3</mn><mi>α</mi></mrow></mfrac><mo>∼</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>3</mn><mn>9</mn><mn>8</mn><mn>1</mn></mrow><annotation encoding="application/x-tex">\theta_{green} = \frac{4 + \alpha}{10 + 3\alpha} \sim 0.3981</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height: 0.845108em;"></span><span class="strut bottom" style="height: 1.248439em; vertical-align: -0.403331em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="vlist"><span class="" style="top: 0.15em; margin-right: 0.05em; margin-left: -0.02778em;"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right: 0.03588em;">g</span><span class="mord mathit" style="margin-right: 0.02778em;">r</span><span class="mord mathit">e</span><span class="mord mathit">e</span><span class="mord mathit">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord reset-textstyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span class="" style="top: 0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord">1</span><span class="mord">0</span><span class="mbin">+</span><span class="mord">3</span><span class="mord mathit" style="margin-right: 0.0037em;">α</span></span></span></span><span class="" style="top: -0.23em;"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span class="" style="top: -0.394em;"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord">4</span><span class="mbin">+</span><span class="mord mathit" style="margin-right: 0.0037em;">α</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mrel">∼</span><span class="mord">0</span><span class="mord">.</span><span class="mord">3</span><span class="mord">9</span><span class="mord">8</span><span class="mord">1</span></span></span></span></span></li>
<li>파랑: <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>θ</mi><mrow><mi>b</mi><mi>l</mi><mi>u</mi><mi>e</mi></mrow></msub><mo>=</mo><mfrac><mrow><mn>0</mn><mo>+</mo><mi>α</mi></mrow><mrow><mn>1</mn><mn>0</mn><mo>+</mo><mn>3</mn><mi>α</mi></mrow></mfrac><mo>∼</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>0</mn><mn>0</mn><mn>9</mn><mn>7</mn></mrow><annotation encoding="application/x-tex">\theta_{blue} = \frac{0 + \alpha}{10 + 3\alpha} \sim 0.0097</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height: 0.845108em;"></span><span class="strut bottom" style="height: 1.248439em; vertical-align: -0.403331em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">θ</span><span class="vlist"><span class="" style="top: 0.15em; margin-right: 0.05em; margin-left: -0.02778em;"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">b</span><span class="mord mathit" style="margin-right: 0.01968em;">l</span><span class="mord mathit">u</span><span class="mord mathit">e</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord reset-textstyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span class="" style="top: 0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord">1</span><span class="mord">0</span><span class="mbin">+</span><span class="mord">3</span><span class="mord mathit" style="margin-right: 0.0037em;">α</span></span></span></span><span class="" style="top: -0.23em;"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span class="" style="top: -0.394em;"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord">0</span><span class="mbin">+</span><span class="mord mathit" style="margin-right: 0.0037em;">α</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mrel">∼</span><span class="mord">0</span><span class="mord">.</span><span class="mord">0</span><span class="mord">0</span><span class="mord">9</span><span class="mord">7</span></span></span></span></span></li>
</ul>

<p>이 되는 것을 알 수 있습니다.</p>

<h3 id="">예제</h3>

<p>이제 텍스트에 대한 likelihood를 직접 구해보겠습니다. 다음 두 문장을 고려해 봅시다.</p>

<pre><code>John likes to watch movies. Mary likes movies too.
John also likes to watch football games.
</code></pre>

<p>첫 번째 문장으로 텍스트 모델을 트레이닝 (training) 한 뒤에, 이 모델에서 두 번째 문장을 생성할 확률을 구해보겠습니다. 먼저, 이전과 같이 두 문장에서 다음과 같이 단어 사전을 만들 수 있습니다.</p>

<pre><code>{
"John": 0,
"likes": 1,
"to": 2,
"watch": 3,
"movies": 4,
"Mary": 5,
"too": 6
}
</code></pre>

<p>그리고 첫 번째 문장은 다음과 같은 7차원 벡터로 표현됩니다. 일반적으로 텍스트 분석에서 각각의 단어는 하나의 차원을 가집니다. 예를 들어 사탕을 뽑아주는 기계에서 빨간색, 녹색, 그리고 파란색의 3가지 종류가 있었다면, 이 첫번째 문장에서 만들어진 모델은 버튼 하나를 누를 때마다 7가지 단어 중 하나를 뽑아주는 셈입니다. 그리고 그 확률은 다음과 같습니다.</p>

<pre><code>[1, 2, 1, 1, 2, 1, 1]
</code></pre>

<p>첫 번째 문장에 들어 있는 단어의 수는 <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>9</mn></mrow><annotation encoding="application/x-tex">9</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height: 0.64444em;"></span><span class="strut bottom" style="height: 0.64444em; vertical-align: 0em;"></span><span class="base textstyle uncramped"><span class="mord">9</span></span></span></span></span> 개, 단어 사전에 들어있는 단어의 개수는 <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>7</mn></mrow><annotation encoding="application/x-tex">7</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height: 0.64444em;"></span><span class="strut bottom" style="height: 0.64444em; vertical-align: 0em;"></span><span class="base textstyle uncramped"><span class="mord">7</span></span></span></span></span>개 입니다. 두 번째 문장을 생성할 확률은, 두 번째 문장 안에 있는 단어 하나 하나를 첫 번째 문장에서 생성할 확률의 곱으로 정의됩니다. 위에서 배운 laplace smoothing을 적용하면, 첫 번째 단어인 <code>John</code>을 트레이닝된 텍스트 모델을 통해 생성할 확률은 <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mn>1</mn><mo>+</mo><mi>α</mi></mrow><mrow><mn>9</mn><mo>+</mo><mn>7</mn><mi>α</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{1 + \alpha}{9 + 7\alpha}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height: 0.845108em;"></span><span class="strut bottom" style="height: 1.248439em; vertical-align: -0.403331em;"></span><span class="base textstyle uncramped"><span class="mord reset-textstyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span class="" style="top: 0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord">9</span><span class="mbin">+</span><span class="mord">7</span><span class="mord mathit" style="margin-right: 0.0037em;">α</span></span></span></span><span class="" style="top: -0.23em;"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span class="" style="top: -0.394em;"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord">1</span><span class="mbin">+</span><span class="mord mathit" style="margin-right: 0.0037em;">α</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span></span> 가 되는데, 분자의 1은 트레이닝 텍스트에 있는 <code>John</code>의 개수, 분모의 9는 트레이닝 텍스트에 있는 전체 단어의 개수, 그리고 7은 트레이닝 텍스트에 있는 서로 다른 단어의 개수, 혹은 단어 사전에 들어있는 단어의 개수를 의미합니다. 마찬가지로 <code>also</code> 단어를 생성할 확률은 마찬가지로 <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mn>0</mn><mo>+</mo><mi>α</mi></mrow><mrow><mn>9</mn><mo>+</mo><mn>7</mn><mi>α</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{0 + \alpha}{9 + 7\alpha}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height: 0.845108em;"></span><span class="strut bottom" style="height: 1.248439em; vertical-align: -0.403331em;"></span><span class="base textstyle uncramped"><span class="mord reset-textstyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span class="" style="top: 0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord">9</span><span class="mbin">+</span><span class="mord">7</span><span class="mord mathit" style="margin-right: 0.0037em;">α</span></span></span></span><span class="" style="top: -0.23em;"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span class="" style="top: -0.394em;"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord">0</span><span class="mbin">+</span><span class="mord mathit" style="margin-right: 0.0037em;">α</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span></span>, 그리고 <code>likes</code> 단어를 생성할 확률은 <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mn>2</mn><mo>+</mo><mi>α</mi></mrow><mrow><mn>9</mn><mo>+</mo><mn>7</mn><mi>α</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{2 + \alpha}{9 + 7\alpha}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height: 0.845108em;"></span><span class="strut bottom" style="height: 1.248439em; vertical-align: -0.403331em;"></span><span class="base textstyle uncramped"><span class="mord reset-textstyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span class="" style="top: 0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord">9</span><span class="mbin">+</span><span class="mord">7</span><span class="mord mathit" style="margin-right: 0.0037em;">α</span></span></span></span><span class="" style="top: -0.23em;"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span class="" style="top: -0.394em;"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord">2</span><span class="mbin">+</span><span class="mord mathit" style="margin-right: 0.0037em;">α</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span></span> 가 됩니다. 계속 진행하면서 이것들을 전부 곱하면, 두 번째 텍스트를 생성할 확률은 다음과 같습니다:</p>

<p><span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mn>1</mn><mo>+</mo><mi>α</mi></mrow><mrow><mn>9</mn><mo>+</mo><mn>7</mn><mi>α</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{1 + \alpha}{9 + 7\alpha}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height: 0.845108em;"></span><span class="strut bottom" style="height: 1.248439em; vertical-align: -0.403331em;"></span><span class="base textstyle uncramped"><span class="mord reset-textstyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span class="" style="top: 0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord">9</span><span class="mbin">+</span><span class="mord">7</span><span class="mord mathit" style="margin-right: 0.0037em;">α</span></span></span></span><span class="" style="top: -0.23em;"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span class="" style="top: -0.394em;"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord">1</span><span class="mbin">+</span><span class="mord mathit" style="margin-right: 0.0037em;">α</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span></span>(john)<span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>×</mo><mfrac><mrow><mn>0</mn><mo>+</mo><mi>α</mi></mrow><mrow><mn>9</mn><mo>+</mo><mn>7</mn><mi>α</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\times \frac{0 + \alpha}{9 + 7\alpha}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height: 0.845108em;"></span><span class="strut bottom" style="height: 1.248439em; vertical-align: -0.403331em;"></span><span class="base textstyle uncramped"><span class="mord">×</span><span class="mord reset-textstyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span class="" style="top: 0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord">9</span><span class="mbin">+</span><span class="mord">7</span><span class="mord mathit" style="margin-right: 0.0037em;">α</span></span></span></span><span class="" style="top: -0.23em;"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span class="" style="top: -0.394em;"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord">0</span><span class="mbin">+</span><span class="mord mathit" style="margin-right: 0.0037em;">α</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span></span>(also) <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>×</mo><mfrac><mrow><mn>1</mn><mo>+</mo><mi>α</mi></mrow><mrow><mn>9</mn><mo>+</mo><mn>7</mn><mi>α</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\times \frac{1 + \alpha}{9 + 7\alpha}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height: 0.845108em;"></span><span class="strut bottom" style="height: 1.248439em; vertical-align: -0.403331em;"></span><span class="base textstyle uncramped"><span class="mord">×</span><span class="mord reset-textstyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span class="" style="top: 0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord">9</span><span class="mbin">+</span><span class="mord">7</span><span class="mord mathit" style="margin-right: 0.0037em;">α</span></span></span></span><span class="" style="top: -0.23em;"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span class="" style="top: -0.394em;"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord">1</span><span class="mbin">+</span><span class="mord mathit" style="margin-right: 0.0037em;">α</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span></span>(likes) <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>×</mo><mfrac><mrow><mn>1</mn><mo>+</mo><mi>α</mi></mrow><mrow><mn>9</mn><mo>+</mo><mn>7</mn><mi>α</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\times \frac{1 + \alpha}{9 + 7\alpha}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height: 0.845108em;"></span><span class="strut bottom" style="height: 1.248439em; vertical-align: -0.403331em;"></span><span class="base textstyle uncramped"><span class="mord">×</span><span class="mord reset-textstyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span class="" style="top: 0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord">9</span><span class="mbin">+</span><span class="mord">7</span><span class="mord mathit" style="margin-right: 0.0037em;">α</span></span></span></span><span class="" style="top: -0.23em;"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span class="" style="top: -0.394em;"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord">1</span><span class="mbin">+</span><span class="mord mathit" style="margin-right: 0.0037em;">α</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span></span>(to) <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>×</mo><mfrac><mrow><mn>1</mn><mo>+</mo><mi>α</mi></mrow><mrow><mn>9</mn><mo>+</mo><mn>7</mn><mi>α</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\times \frac{1 + \alpha}{9 + 7\alpha}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height: 0.845108em;"></span><span class="strut bottom" style="height: 1.248439em; vertical-align: -0.403331em;"></span><span class="base textstyle uncramped"><span class="mord">×</span><span class="mord reset-textstyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span class="" style="top: 0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord">9</span><span class="mbin">+</span><span class="mord">7</span><span class="mord mathit" style="margin-right: 0.0037em;">α</span></span></span></span><span class="" style="top: -0.23em;"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span class="" style="top: -0.394em;"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord">1</span><span class="mbin">+</span><span class="mord mathit" style="margin-right: 0.0037em;">α</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span></span>(watch) <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>×</mo><mfrac><mrow><mn>0</mn><mo>+</mo><mi>α</mi></mrow><mrow><mn>9</mn><mo>+</mo><mn>7</mn><mi>α</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\times \frac{0 + \alpha}{9 + 7\alpha}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height: 0.845108em;"></span><span class="strut bottom" style="height: 1.248439em; vertical-align: -0.403331em;"></span><span class="base textstyle uncramped"><span class="mord">×</span><span class="mord reset-textstyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span class="" style="top: 0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord">9</span><span class="mbin">+</span><span class="mord">7</span><span class="mord mathit" style="margin-right: 0.0037em;">α</span></span></span></span><span class="" style="top: -0.23em;"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span class="" style="top: -0.394em;"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord">0</span><span class="mbin">+</span><span class="mord mathit" style="margin-right: 0.0037em;">α</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span></span>(football) <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>×</mo><mfrac><mrow><mn>0</mn><mo>+</mo><mi>α</mi></mrow><mrow><mn>9</mn><mo>+</mo><mn>7</mn><mi>α</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\times \frac{0 + \alpha}{9 + 7\alpha}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height: 0.845108em;"></span><span class="strut bottom" style="height: 1.248439em; vertical-align: -0.403331em;"></span><span class="base textstyle uncramped"><span class="mord">×</span><span class="mord reset-textstyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span class="" style="top: 0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord">9</span><span class="mbin">+</span><span class="mord">7</span><span class="mord mathit" style="margin-right: 0.0037em;">α</span></span></span></span><span class="" style="top: -0.23em;"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span class="" style="top: -0.394em;"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord">0</span><span class="mbin">+</span><span class="mord mathit" style="margin-right: 0.0037em;">α</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span></span>(games)</p>

<p>Laplace smoothing에 의해, 트레이닝 텍스트에 없었던 <code>also</code>, <code>football</code>, <code>games</code> 와 같은 단어도 잘 처리된 것을 알 수 있습니다. <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>α</mi><mo>=</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>1</mn></mrow><annotation encoding="application/x-tex">\alpha = 0.1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height: 0.64444em;"></span><span class="strut bottom" style="height: 0.64444em; vertical-align: 0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right: 0.0037em;">α</span><span class="mrel">=</span><span class="mord">0</span><span class="mord">.</span><span class="mord">1</span></span></span></span></span> 일 때 이 값은 <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>3</mn><mi mathvariant="normal">.</mi><mn>4</mn><mn>5</mn><mn>9</mn><mn>3</mn><mo>∗</mo><mn>1</mn><msup><mn>0</mn><mrow><mo>−</mo><mn>1</mn><mn>0</mn></mrow></msup></mrow><annotation encoding="application/x-tex">3.4593 * 10^{-10}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height: 0.814108em;"></span><span class="strut bottom" style="height: 0.814108em; vertical-align: 0em;"></span><span class="base textstyle uncramped"><span class="mord">3</span><span class="mord">.</span><span class="mord">4</span><span class="mord">5</span><span class="mord">9</span><span class="mord">3</span><span class="mbin">∗</span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="vlist"><span class="" style="top: -0.363em; margin-right: 0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord">−</span><span class="mord">1</span><span class="mord">0</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span>​</span></span></span></span></span></span></span> 입니다. 굉장히 낮은 확률임을 알 수 있습니다.</p>

<p>일반적으로 자연어 처리에서 트레이닝된 모델이 테스트 데이터를 생성할 확률은 굉장히 낮습니다. 그렇기 때문에 확률의 절대값보다는 상대값을 많이 사용합니다. 예를 들어, 어떤 텍스트 X가 모델 A에서 생성될 확률이 <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>3</mn><mi mathvariant="normal">.</mi><mn>5</mn><mo>∗</mo><mn>1</mn><msup><mn>0</mn><mrow><mo>−</mo><mn>1</mn><mn>2</mn></mrow></msup></mrow><annotation encoding="application/x-tex">3.5*10^{-12}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height: 0.814108em;"></span><span class="strut bottom" style="height: 0.814108em; vertical-align: 0em;"></span><span class="base textstyle uncramped"><span class="mord">3</span><span class="mord">.</span><span class="mord">5</span><span class="mbin">∗</span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="vlist"><span class="" style="top: -0.363em; margin-right: 0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord">−</span><span class="mord">1</span><span class="mord">2</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span>​</span></span></span></span></span></span></span> 이고 모델 B 에서 생성될 확률이 <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>7</mn><mi mathvariant="normal">.</mi><mn>0</mn><mo>∗</mo><mn>1</mn><msup><mn>0</mn><mrow><mo>−</mo><mn>1</mn><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">7.0 * 10^{-11}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height: 0.814108em;"></span><span class="strut bottom" style="height: 0.814108em; vertical-align: 0em;"></span><span class="base textstyle uncramped"><span class="mord">7</span><span class="mord">.</span><span class="mord">0</span><span class="mbin">∗</span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="vlist"><span class="" style="top: -0.363em; margin-right: 0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord">−</span><span class="mord">1</span><span class="mord">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span class="" style="font-size: 0em;">​</span></span>​</span></span></span></span></span></span></span> 일 경우, X가 모델 B에서 생성될 확률이 모델 A에서 생성될 확률보다 20배 더 높으므로, 모델 B로 분류하는 것이 더 적당합니다. 다음 과제에서 이것을 직접 구현하겠습니다.</p>

<h2 id="-1">과제</h2>

<p>문서의 likelihood를 계산하는 프로그램을 작성하겠습니다. 예제와 동일하게, 먼저 첫 번째 문장으로 텍스트 모델을 트레이닝 한 뒤에, 이 모델로 두 번째 문장을 생성할 확률을 구합니다. 확률을 구할 때, Laplace smoothing 을 적용해야 합니다.</p>

<ol>
<li>이미 구현된 <code>create_BOW</code> 함수를 이용하여 트레이닝 데이터에 대한 bag-of-words 모델을 생성합니다.</li>
<li>테스트 데이터에 대한 bag-of-words 모델도 생성합니다.</li>
<li>alpha 값을 입력받습니다.</li>
<li>함수 <code>calculate_doc_prob</code> 에서 Laplace smoothing을 이용해, 트레이닝 데이터에서 생성된 bag-of-words 모델이 테스트 데이터를 생성할 <strong>로그 확률</strong> 을 구합니다. 로그 확률을 구하는 이유는, 긴 문장의 경우 생성 확률값이 매우 작아져 Python 에서 기본으로 사용하는 floating point 형식에서 오차가 발생하기 때문입니다.
<ul>
<li>로그값은 <code>math.log()</code> 함수를 이용해 구할 수 있습니다.</li>
<li><strong>주의</strong>: 한 문장에 같은 단어가 여러 번 나온다면, 여러 번 나오는 만큼 그 단어의 생성 확률을 곱해야 합니다. 예를 들어 <code>john</code> 이라는 단어가 세 번 나올 경우 <code>john</code> 이 생성될 확률을 3번 곱합니다.</li>
<li><strong>주의 2</strong>: 계산 중에 로그값을 취하면서 계속 더해나가야 합니다. 모든 곱셈이 끝난 뒤 로그 값을 취하면 오차 발생으로 인해 채점이 제대로 되지 않을 수 있습니다. 다음 로그의 성질을 활용하세요: <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>l</mi><mi>o</mi><mi>g</mi><mo>(</mo><mi>a</mi><mi>b</mi><mi>c</mi><mo>)</mo><mo>=</mo><mi>l</mi><mi>o</mi><mi>g</mi><mo>(</mo><mi>a</mi><mo>)</mo><mo>+</mo><mi>l</mi><mi>o</mi><mi>g</mi><mo>(</mo><mi>b</mi><mo>)</mo><mo>+</mo><mi>l</mi><mi>o</mi><mi>g</mi><mo>(</mo><mi>c</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">log(abc) = log(a) + log(b) + log(c)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height: 0.75em;"></span><span class="strut bottom" style="height: 1em; vertical-align: -0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right: 0.01968em;">l</span><span class="mord mathit">o</span><span class="mord mathit" style="margin-right: 0.03588em;">g</span><span class="mopen">(</span><span class="mord mathit">a</span><span class="mord mathit">b</span><span class="mord mathit">c</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathit" style="margin-right: 0.01968em;">l</span><span class="mord mathit">o</span><span class="mord mathit" style="margin-right: 0.03588em;">g</span><span class="mopen">(</span><span class="mord mathit">a</span><span class="mclose">)</span><span class="mbin">+</span><span class="mord mathit" style="margin-right: 0.01968em;">l</span><span class="mord mathit">o</span><span class="mord mathit" style="margin-right: 0.03588em;">g</span><span class="mopen">(</span><span class="mord mathit">b</span><span class="mclose">)</span><span class="mbin">+</span><span class="mord mathit" style="margin-right: 0.01968em;">l</span><span class="mord mathit">o</span><span class="mord mathit" style="margin-right: 0.03588em;">g</span><span class="mopen">(</span><span class="mord mathit">c</span><span class="mclose">)</span></span></span></span></span></li>
<li><strong>주의 3</strong>: Laplace smoothing 시에 <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi><mo>=</mo></mrow><annotation encoding="application/x-tex">d =</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height: 0.69444em;"></span><span class="strut bottom" style="height: 0.69444em; vertical-align: 0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">d</span><span class="mrel">=</span></span></span></span></span> <code>training 데이터에 있는 서로 다른 단어의 개수</code> 로 사용하겠습니다. <code>training + testing 데이터에 있는 서로 다른 단어의 개수</code> 를 사용하지 않는 이유는 모델 training 시 어떤 test 데이터가 들어올 지 알 수 없으며, test 데이터가 바뀜에 따라서 모델에서 특정 단어가 발생할 확률이 바뀌는 것이 문제가 되기 때문입니다.</li></ul></li>
<li>계산한 로그 확률값을 리턴합니다.</li>
</ol>

<h3 id="-2">입력</h3>

<p>문장 두 줄과 <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>α</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height: 0.43056em;"></span><span class="strut bottom" style="height: 0.43056em; vertical-align: 0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right: 0.0037em;">α</span></span></span></span></span> 값이 차례대로 입력됩니다.</p>

<h3 id="-3">출력</h3>

<p>이전 과제에서 연습한 bag-of-words 함수를 사용하여, 첫 번째 문장을 이용해 트레이닝한 텍스트 모델에서 두 번째 문장을 생성 (generate) 할 확률의 <strong>로그값</strong> 을 계산하여 출력합니다.</p>

<h3 id="-4">테스트 입력</h3>

<pre><code>John likes to watch movies. Mary likes movies too.
John also likes to watch football games.
0.1
</code></pre>

<h3 id="-5">테스트 출력</h3>

<pre><code>-21.78476859340514
</code></pre></div></div>


</body>
</html>